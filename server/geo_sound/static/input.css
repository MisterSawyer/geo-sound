@import "tailwindcss";

@layer components {
  .header-bar {
    @apply fixed inset-x-0 top-0 h-18 flex items-center justify-between border-b border-gray-200 px-4 z-50 bg-white/60 backdrop-blur-md shadow-md;

    @apply sm:h-14;
  }

  /* Base style for all header buttons */
  .header-btn {
    /* Default: mobile (big) */
    @apply h-14 w-14 px-4 py-3 text-lg flex items-center justify-center rounded-lg transition-colors font-medium text-white;
    @apply sm:h-12 sm:w-12;
  }

  .header-btn-pressed {
    @apply ring-2 ring-offset-1 ring-[#3388ff];
    box-shadow: inset 0 4px 8px rgba(0, 0, 0, 0.5);
  }

  .header-btn-green {
    @apply bg-green-600 hover:bg-green-700;
  }

  .header-btn-blue {
    @apply bg-blue-600 hover:bg-blue-700;
  }

  .header-btn-burger {
    @apply bg-blue-600 hover:bg-blue-700 font-bold text-lg;
  }

  .tracks-list-panel {
    @apply fixed top-18 right-0 h-[calc(100vh-3.5rem)] w-[18rem] border-l border-gray-200 z-40 overflow-y-auto p-4 bg-white/60 backdrop-blur-md shadow-lg transform translate-x-0 transition-transform duration-300;

    @apply sm:top-14 sm:w-[28rem];
  }

  .tracks-list-panel-closed {
    transform: translateX(100%);
    /* hidden off screen to the right */
  }

  .tracks-list-panel-open {
    transform: translateX(0);
    /* visible */
  }

  #tracks-list-panel::-webkit-scrollbar {
    width: 10px;
  }

  #tracks-list-panel::-webkit-scrollbar-track {
    background: transparent;
  }

  #tracks-list-panel::-webkit-scrollbar-thumb {
    background: #94a3b8;
    /* slate-400 */
    border-radius: 5px;
  }

  #tracks-list-panel::-webkit-scrollbar-thumb:hover {
    background: #64748b;
    /* slate-500 */
  }

  .track-card {
    @apply mb-4 p-4 bg-white rounded-lg shadow hover:shadow-md hover:bg-blue-50 transition cursor-pointer;
  }

  /* Active state when linked to a map pin */
  .track-card.active {
    @apply bg-blue-100 shadow-md border border-blue-300;
  }

  .track-title {
    @apply font-semibold break-words leading-tight;
    color: var(--track-color, #3388ff);

    display: -webkit-box;
    /* enables multi-line ellipsis */
    -webkit-line-clamp: 2;
    /* show max 2 lines */
    -webkit-box-orient: vertical;
    overflow: hidden;
    text-overflow: ellipsis;
    word-break: break-word;
    /* break long words if needed */
    max-height: 3.2em;
    /* ~2 lines based on font size */
  }

  .track-header {
    @apply flex items-center justify-between mb-2 rounded-md px-2 py-1;
    background-color: var(--track-bg, transparent);
  }

  .track-edit-input {
    @apply border border-gray-300 rounded-md px-2 py-1 focus:outline-none focus:ring focus:ring-blue-200 h-9 max-w-22 align-middle;
    /* force consistent height */
    @apply sm:max-w-36;
  }

  /* Base style shared by all panels */
  .panel {
    @apply absolute top-20 right-4 w-80 max-w-full border border-gray-200 rounded-xl p-5 z-50 transform transition-all duration-300 ease-out bg-white/60 backdrop-blur-md shadow-xl;

    @apply sm:top-16;
  }

  .panel-closed {
    @apply -translate-y-4 opacity-0 scale-95 pointer-events-none;
  }

  .panel-open {
    @apply translate-y-0 opacity-100 scale-100;
  }

  .auth-logged-in {
    display: none;
  }

  .form-input {
    @apply border border-gray-300 rounded-md px-2 py-1 focus:outline-none focus:ring focus:ring-blue-200 h-9 align-middle;
    /* force consistent height */
  }

  .form-color {
    @apply w-9 h-9 cursor-pointer rounded-md border border-gray-300 p-0 align-middle;
  }

  .form-btn {
    @apply bg-blue-600 text-white rounded-md px-3 py-2 hover:bg-blue-700;
  }

  /* Base file input style */
  .form-input[type="file"] {
    @apply block w-full text-sm text-gray-700 border border-gray-300 rounded-md cursor-pointer focus:outline-none focus:ring focus:ring-blue-200 h-9;
    /* same height as other inputs */
    padding: 0;
    /* let the button control padding */
  }

  /* "Choose file" button */
  .form-input[type="file"]::file-selector-button {
    @apply bg-blue-600 text-white text-sm font-medium px-3 py-1.5 rounded-md border-0 cursor-pointer mr-3 transition h-9;
    /* force button height to match */
  }

  .form-input[type="file"]::file-selector-button:hover {
    @apply bg-blue-700;
  }

  /* Safari / old WebKit */
  .form-input[type="file"]::-webkit-file-upload-button {
    @apply bg-blue-600 text-white text-sm font-medium px-3 py-1.5 rounded-md border-0 cursor-pointer mr-3 transition h-9;
  }

  .form-input[type="file"]::-webkit-file-upload-button:hover {
    @apply bg-blue-700;
  }

  #map {
    -webkit-user-select: none;
    -ms-user-select: none;
    user-select: none;
    -webkit-touch-callout: none;
  }

  /* Controls grid: 3 cols top row, 3 cols bottom row */
  .plyr--audio .plyr__controls {
    display: grid !important;
    grid-template-columns: auto 1fr auto;
    /* play | progress | volume */
    grid-template-rows: auto auto;
    /* row1 = controls, row2 = timer+speaker */
    align-items: center;
    gap: 0.4rem 0.6rem;
    background-color: transparent !important;
    box-shadow: none !important;
    border: none !important;
  }

  /* Row 1 col 1: play */
  .plyr--audio .plyr__controls>.plyr__control[data-plyr="play"] {
    grid-column: 1;
    grid-row: 2;
    justify-self: start;
  }

  /* Row 1 col 1: play */
  .plyr--audio .plyr__controls .plyr__volume {
    grid-column: 3;
    grid-row: 2;
    justify-self: start;
  }

  /* Row 1 col 2: progress */
  .plyr--audio .plyr__progress__container {
    grid-column: 1 / span 3;
    grid-row: 1;
    width: 100% !important;
  }

  .plyr-time-row {
    grid-column: 2;
    grid-row: 2;
    @apply flex justify-end items-end text-sm text-gray-700;
    text-align: center;
    margin-right: 0rem !important;
  }

  .plyr--audio .plyr__time--duration,
  .plyr--audio .plyr__time--current {
    margin-right: 0rem !important;
  }

  .plyr-buttons-row {
    @apply flex justify-center items-center gap-2 mt-1;
  }

  .popup-title {
    @apply block text-center font-semibold text-gray-800;

    display: -webkit-box;
    /* enables multi-line ellipsis */
    -webkit-line-clamp: 2;
    /* show max 2 lines */
    -webkit-box-orient: vertical;
    overflow: hidden;
    text-overflow: ellipsis;
    word-break: break-word;
    /* break long words if needed */
    max-height: 3.2em;
    /* ~2 lines based on font size */

  }

  .popup-toggle {
    @apply bg-white text-gray-600 rounded-md transition;
  }

  .popup-toggle:hover {
    background-color: #3388ff;
    /* static hover color */
    color: white;
  }

  .popup-owner {
    @apply block text-left text-gray-400;
  }
}